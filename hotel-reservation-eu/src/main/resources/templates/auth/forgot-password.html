<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/base :: html}">
<head>
    <title>忘记密码</title>
</head>
<body>
    <main th:fragment="content" class="auth-container">
        <div class="auth-card">
            <div class="card">
                <div class="card-header bg-white text-center py-4">
                    <h2 class="mb-0">
                        <i class="fas fa-key text-warning me-2"></i>
                        忘记密码
                    </h2>
                    <p class="text-muted mb-0">请输入您的邮箱地址，我们将发送密码重置链接</p>
                </div>
                
                <div class="card-body p-4">
                    <!-- 错误消息 -->
                    <div th:if="${errorMessage}" class="alert alert-danger alert-dismissible fade show" role="alert">
                        <i class="fas fa-exclamation-circle me-2"></i>
                        <span th:text="${errorMessage}"></span>
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                    
                    <!-- 忘记密码表单 -->
                    <form th:action="@{/auth/forgot-password}" method="post" th:object="${forgotPasswordRequest}" id="forgotPasswordForm">
                        <div class="mb-4">
                            <label for="email" class="form-label">
                                <i class="fas fa-envelope me-2"></i>邮箱地址
                            </label>
                            <input type="email" 
                                   class="form-control form-control-lg" 
                                   id="email" 
                                   th:field="*{email}"
                                   placeholder="请输入您注册时使用的邮箱"
                                   required>
                            <div th:if="${#fields.hasErrors('email')}" class="text-danger mt-2">
                                <small th:errors="*{email}"></small>
                            </div>
                        </div>
                        
                        <div class="d-grid mb-4">
                            <button type="submit" class="btn btn-warning btn-lg" id="forgotPasswordBtn">
                                <i class="fas fa-paper-plane me-2"></i>发送重置链接
                            </button>
                        </div>
                    </form>
                    
                    <!-- 信息提示 -->
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>温馨提示：</strong>
                        <ul class="mb-0 mt-2">
                            <li>重置链接将在24小时内有效</li>
                            <li>如果您没有收到邮件，请检查垃圾邮件文件夹</li>
                            <li>如果邮箱地址不存在，您将不会收到任何邮件</li>
                        </ul>
                    </div>
                    
                    <!-- 链接 -->
                    <div class="text-center">
                        <p class="mb-2">
                            想起密码了？
                            <a th:href="@{/auth/login}" class="text-decoration-none fw-bold">
                                返回登录
                            </a>
                        </p>
                        <p class="mb-0">
                            还没有账户？
                            <a th:href="@{/auth/register}" class="text-decoration-none">
                                立即注册
                            </a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 页面特定脚本 -->
    <th:block th:fragment="page-scripts">
        <script>
            $(document).ready(function() {
                // 表单提交处理
                $('#forgotPasswordForm').submit(function() {
                    const forgotPasswordBtn = $('#forgotPasswordBtn');
                    const originalText = forgotPasswordBtn.html();
                    showLoading(forgotPasswordBtn[0]);
                    
                    // 防止多次提交
                    setTimeout(function() {
                        if (forgotPasswordBtn.is(':disabled')) {
                            hideLoading(forgotPasswordBtn[0], originalText);
                        }
                    }, 3000);
                });
            });
        </script>
    </th:block>
</body>
</html> 